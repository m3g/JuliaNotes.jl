<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Development workflow · JuliaNotes.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="JuliaNotes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">JuliaNotes.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../fastrepl/">Cool and fast REPL</a></li><li class="is-active"><a class="tocitem" href>Development workflow</a><ul class="internal"><li><a class="tocitem" href="#juliaup"><span>juliaup</span></a></li><li><a class="tocitem" href="#Revise-and-startup.jl"><span>Revise and startup.jl</span></a></li><li><a class="tocitem" href="#Environments"><span>Environments</span></a></li></ul></li><li><a class="tocitem" href="../modules/">Modules and Revise</a></li><li><a class="tocitem" href="../loopscopes/">Scope of loops</a></li><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><a class="tocitem" href="../assignment/">Assignment and mutation</a></li><li><a class="tocitem" href="../instability/">Type instability</a></li><li><a class="tocitem" href="../anonymous/">Anonymous functions</a></li><li><a class="tocitem" href="../memory/">Tracking allocations</a></li><li><a class="tocitem" href="../immutable/">Immutable variables</a></li><li><a class="tocitem" href="../nomethod/">ERROR: No method...</a></li><li><a class="tocitem" href="../typevariance/">Vector{Int} &lt;: Vector{Real} is false???</a></li><li><a class="tocitem" href="../figures/">Figures and LaTeX</a></li><li><a class="tocitem" href="../new_package/">Create new package</a></li><li><a class="tocitem" href="../publish_docs/">Publish Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Development workflow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Development workflow</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/JuliaNotes.jl/blob/main/docs/src/workflow.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Nice-workflows-for-using-and-developing-Julia-1.9"><a class="docs-heading-anchor" href="#Nice-workflows-for-using-and-developing-Julia-1.9">Nice workflows for using and developing Julia 1.9+</a><a id="Nice-workflows-for-using-and-developing-Julia-1.9-1"></a><a class="docs-heading-anchor-permalink" href="#Nice-workflows-for-using-and-developing-Julia-1.9" title="Permalink"></a></h1><p>This a brief description of some nice development workflows for Julia, particularly for versions 1.9 or greater. This workflows are usually fairly personal, so many other useful ones may exist. </p><h2 id="juliaup"><a class="docs-heading-anchor" href="#juliaup">juliaup</a><a id="juliaup-1"></a><a class="docs-heading-anchor-permalink" href="#juliaup" title="Permalink"></a></h2><p>The <a href="https://github.com/JuliaLang/juliaup">juliaup</a> tool allows an easy handling of Julia installations and versioning. In short, if you are using Linux, install <code>juliaup</code> with:</p><pre><code class="language-bash hljs">curl -fsSL https://install.julialang.org | sh</code></pre><p>then, close the terminal, start it again. The <code>juliaup</code> and <code>julia</code> executables will be available in your path. By default, <code>juliaup</code> installs the latest stable version of Julia, which as of the writing of this text was 1.8.5. We want to work with the upcoming 1.9 series, so we start by installing it:</p><pre><code class="language-bash hljs">juliaup add 1.9</code></pre><p>which will currently install, as of today, the 1.9.0-rc1 version of Julia. Then, lets make it the default Julia:</p><pre><code class="language-bash hljs">juliaup default 1.9</code></pre><h2 id="Revise-and-startup.jl"><a class="docs-heading-anchor" href="#Revise-and-startup.jl">Revise and startup.jl</a><a id="Revise-and-startup.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Revise-and-startup.jl" title="Permalink"></a></h2><p><code>Revise.jl</code> is a fundamental tool for Julia development and use. It allows one to track changes to files and, thus, to very effectively develop new functions, tune plots, etc, by editing an script in parallel to an active Julia section. Thus, add revise to your main environment:</p><pre><code class="language-julia-repl hljs">julia&gt; ] add Revise</code></pre><p>(remembering that the <code>]</code> will take you to the package manager prompt: <code>(@v1.9) pkg&gt;</code>).</p><p>Next, let us guarantee that <code>Revise</code> is always loaded on startup. Add it to (or create the file) </p><pre><code class="nohighlight hljs">~/.julia/config/startup.j</code></pre><p>and to it the line</p><pre><code class="language-julia hljs">using Revise</code></pre><p>which will make <code>Revise</code> to be loaded on each Julia startup. </p><h4 id="Why-Revise"><a class="docs-heading-anchor" href="#Why-Revise">Why Revise</a><a id="Why-Revise-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Revise" title="Permalink"></a></h4><p>With Revise loaded, it is possible to edit/develop scripts simply modifying the script and re-running functions in an open Julia section. For example, given the script that  generates some data and then plots it:</p><pre><code class="language-julia hljs">using Plots
function my_data(n)
    data = randn(n)
    return data
end
function my_plot(data)
    plt = plot(data; label=&quot;My data&quot;; linewidth=1)
    return plt
end</code></pre><p>If we save the script in a <code>myplot.jl</code> file, and within Julia, we <code>includet</code> (note the <code>t</code>! - for &quot;track&quot;):</p><pre><code class="language-julia-repl hljs">julia&gt; includet(&quot;./myplot.jl&quot;)

julia&gt; data = my_data(1000);

julia&gt; my_plot(data)</code></pre><p>we generate the plot. Then, without leaving the Julia REPL, we can change any property of the data or the plot in the script, save the file, and re-run the functions changed, and they will reflect automatically the updates to the file. </p><p>The video below illustrates such a feature, by changing the line width of the plot, and executing again the <code>my_plot</code> function. </p><center>
<iframe width="733" style="height:400px" src="https://www.youtube.com/embed/GeldXJ-cgHM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The video illustrates the use of Revise from within VSCode, which is also a recommended tool for an effective workflow, but is not required here nor will be discussed in this text. In any case, if you are using it, install the Julia extension.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The example above illustrates some advantages of splitting Julia code into functions. With that layout, the function <code>my_plot</code> can be repeatedly executed at the REPL, tracking the changes made on the file. The same could be done with the data-generation function, for example, if the data has to be reloaded from different files, for example. Note, additionally, that it is good to structure Julia code in functions for performance reasons (functions get compiled to efficient native code), although in this example that is a essentially irrelevant. </p></div></div><h2 id="Environments"><a class="docs-heading-anchor" href="#Environments">Environments</a><a id="Environments-1"></a><a class="docs-heading-anchor-permalink" href="#Environments" title="Permalink"></a></h2><p>Julia 1.9 makes it particularly appealing to use environments for specific tasks, because the compiled code of the libraries gets stored in a environment-specific manner, making the load times of the libraries quicker than in previous Julia versions. Besides, the use of environments allows one to obtain completely reproducible setups. Let us take the previous script,  but we will load another large package <code>DataFrames</code>, and use it to store the sample data we are creating:</p><pre><code class="language-julia hljs">using Plots
using DataFrames
function my_data(n)
    data = DataFrame(:x =&gt; randn(n))
    return data
end
function my_plot(data)
    plt = plot(data.x; label=&quot;My data&quot;, linewidth=1)
    return plt
end</code></pre><p>Since <code>Plots</code> and <code>DataFrames</code> are relatively heavy packages, they take a while to install and compile. We will do that within an new environment. First, create a directory that will contain the environment files. We choose to save the environments within a <code>~/.JuliaEnvironments</code> directory, but that is completely optional, environments are stored in regular directories:</p><pre><code class="language-bash hljs">mkdir ~/.JuliaEnvironments 
mkdir ~/.JuliaEnvironments/mydataplots</code></pre><p>The <code>mydataplots</code> is the directory where the environment files will be automatically created. </p><p>Then, start Julia and </p><pre><code class="language-julia-repl hljs">julia&gt; ] # go to pkg prompt

(@v1.9) pkg&gt; activate ~/.JuliaEnvironments/mydataplots
  Activating new project at `~/.JuliaEnvironments/mydataplots`

(mydataplots) pkg&gt;</code></pre><p>and note that the <code>pkg&gt;</code> prompt reflects that the <code>mydataplots</code> environment is activated. We now add the necessary packages, which can take some minutes, depending on the internet connection and speed of the computer:</p><pre><code class="language-julia-repl hljs">(mydataplots) pkg&gt; add Plots, DataFrames
   Resolving package versions...
   ...</code></pre><p>after the installation is finished, let us simulate the use of the packages for the first time, which may trigger additional compilation. Type <code>backspace</code> to go back to the Julia prompt, and do:</p><pre><code class="language-julia-repl hljs">julia&gt; using Plots, DataFrames
[ Info: Precompiling Plots [91a5bcdd-55d7-5caf-9e0b-520d859cae80]
[ Info: Precompiling DataFrames [a93c6f00-e57d-5684-b7b6-d8193f3e46c0]
</code></pre><p>which may also take some time (it it well possible that the packages don&#39;t get precompiled, again, on this first <code>using</code>, but sometimes they are because of dependency version updates).</p><p>That&#39;s all. You can quite Julia, and let us move to the directory of the working script:</p><pre><code class="language-bash hljs">cd ~/Documents/mytestscript</code></pre><p>Here we have the <code>script.jl</code> containing the code shown above, using <code>Plots</code> and <code>DataFrames</code>, as example packages.  </p><p>Now start Julia, and activate the <code>mydataplots</code> environment, with:</p><pre><code class="language-julia-repl hljs">julia&gt; ] # go to pkg prompt

(@v1.9) pkg&gt; activate /home/user/.JuliaEnvironments/mydataplots/
  Activating project at `~/.JuliaEnvironments/mydataplots`

(mydataplots) pkg&gt;</code></pre><p>type <code>backspace</code> go back to the Julia prompt, and include the script (here with <code>includet</code>, assuming that <code>Revise</code> is loaded by default):</p><pre><code class="language-julia-repl hljs">julia&gt; includet(&quot;./myscript.jl&quot;)</code></pre><p>This should take now a couple of seconds. And the responsiveness of the function should be good:</p><pre><code class="language-julia-repl hljs">julia&gt; @time data = my_data(1000)
  0.002078 seconds (33 allocations: 18.031 KiB, 94.87% compilation time)
1000×1 DataFrame
  Row │ x          
      │ Float64    
──────┼────────────
    1 │ -2.41804
    2 │ -0.51387
    3 │  0.953752
    4 │  0.738998
    5 │  0.973528
  ⋮   │     ⋮
  997 │  0.707327
  998 │  0.200788
  999 │ -0.84872
 1000 │ -1.49911
   991 rows omitted</code></pre><p>and</p><pre><code class="nohighlight hljs">julia&gt; @time my_plot(data)
  0.635311 seconds (2.83 M allocations: 172.703 MiB, 9.92% gc time, 99.49% compilation time: 72% of which was recompilation)</code></pre><p>Thus, in a few seconds, the script can be completely run, avoiding usual delays of recompilation of the packages involved, which happened often in previous versions of Julia.</p><p>Now, let us automate the activation of the environment, by adding to the top of the script the following first line:</p><pre><code class="language-julia hljs">import Pkg; Pkg.activate(&quot;/home/user/.JuliaEnvironments/mydataplots&quot;) # added line
using Plots
... # script continues</code></pre><p>Now, when including the script, it will automatically activate that environment, and use the packages installed for it. It is even possible to just execute the script from the command-line with an acceptable performance, where the script now, shown below, contains the execution of the functions and saving the plot to a figure:</p><pre><code class="language-bash hljs">user@m3g:~/Documents/mytestscript% time julia myscript.jl 
  Activating project at `~/.JuliaEnvironments/mydataplots`

real	0m5,172s
...</code></pre><p>The complete script is, now:</p><pre><code class="language-julia hljs">import Pkg; Pkg.activate(&quot;/home/user/.JuliaEnvironments/mydataplots&quot;)
using Plots
using DataFrames
function my_data(n)
    data = DataFrame(:x =&gt; randn(n))
    return data
end
function my_plot(data)
    plt = plot(data.x; label=&quot;My data&quot;, linewidth=1)
    return plt
end
data = my_data(1000)
plt = my_plot(data)
savefig(plt,&quot;plot.png&quot;)</code></pre><p>Of course, you can use the same environment for all scripts that require the same set of packages, with the same benefits. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is not impossible that you get some recompilation of the packages from time to time if, in particular, new packages are loaded in the same environment. However, once the packages of the environment are stable, precompilation should only occur when trying to use the same environment in different version of Julia.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fastrepl/">« Cool and fast REPL</a><a class="docs-footer-nextpage" href="../modules/">Modules and Revise »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 13 March 2023 17:39">Monday 13 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
